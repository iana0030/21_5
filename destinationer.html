<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Abril+Fatface|Open+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poiret+One&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/e1ee2b9569.js" crossorigin="anonymous"></script>
    <title>21-5 - Destinationer</title>
    <style>
        @media screen and (min-width:750px) {
            #dest_istand .data-container {
                margin: 0 auto;
                display: grid;
                padding: 2em;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                cursor: pointer;
                grid-gap: 3em;
                ;
                background-color: rgba(97, 134, 165, 0.22);
                border-radius: 5px;
            }

            #dest_istand .data-container h3 {
                color: #fff;
            }

            #dest_istand h1 {
                margin-bottom: 1em;
            }


            #dest_istand .data-container img:hover {
                transform: scale(1.02);
                transition: .8s;
            }
        }
    </style>


</head>

<body>

    <!-- html templates her -->
    <section id="splash"></section>
    <nav id="navbar">
        <div>
            <a href="index.html">
                <img src="logo.svg" alt="logo" id="logo">
            </a>
        </div>
        <ul class="nav_links">
            <li><a href="index.html">Forside</a></li>
            <li><a href="omkostninger.html">Priser</a>
            <li><a href="destinationer.html">Destinationer</a>
            <li><a href="omos.html">Om os</a>
            <li><a href="kontakt_info.html">Kontakt</a>
        </ul>
        <div class="burger">
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>
        </div>
    </nav>

    <nav id="main_nav">

        <ul>
            <div>
                <a href="index.html">
                    <img src="logo.svg" alt="logo" id="logo">
                </a>
            </div>
            <li><a href="index.html">Forside</a></li>
            <li><a href="#">Priser</a>
                <ul class="submenu">
                    <li><a href=omkostninger.html> Alle priser</a></li>
                    <li><a href="pris_family.html"> Mere om Family priser</a></li>
                    <li><a href="pris_grande.html">Mere om Grande priser</a></li>
                    <li><a href="pris_large.html">Mere om Large priser</a></li>
                    <li><a href="gensalg.html">Gensalg af foreninger</a></li>
                    <li><a href="skat_jura_finans.html">Skat og Jura</a></li>
                    <li><a href="investering.html">Investering</a></li>
                </ul>
            </li>
            <li><a href="destinationer.html">Destinationer</a>

            </li>

            <li><a href="#">Om</a>
                <ul class="submenu">
                    <li><a href="omos.html">Om os</a></li>
                    <li><a href="hvem_er_vi.html">Hvem er vi?</a></li>
                    <li><a href="hvorfor.html">Hvorfor 21-5?</a></li>
                    <li><a href="hvordan.html">Hvordan fungerer det?</a></li>
                    <li><a href="hvad_gor_vi.html">Hvad gør vi?</a></li>
                    <li><a href="hvor_ligger_boligerne.html">Placering</a></li>
                    <li><a href="faq.html">Ofte stillede spørgsmål</a></li>
                </ul>
            </li>
            <li><a href="#">Kontakt</a>
                <ul class="submenu">
                    <li><a href="kontakt_info.html">Kontakt os</a></li>
                    <li><a href="orientering.html">Orienteringsmøde</a></li>
                </ul>
            </li>
            <li><a href="#">Familier & Foreninger</a>
                <ul class="submenu">
                    <li><a>Om familier og foreninger</a></li>
                    <li><a>Tidligere foreninger</a></li>
                    <li><a>Udtalelser</a></li>
                    <li><a>Tidligere benyttelse</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    <header id="showcase"></header>
    <section id="dest_istand">
        <h1></h1>
        <div id="overview">
            <ul class="destinationer">
                <li><a href="single.html?id=33">Rom</a></li>
                <li><a href="single.html?id=31">Paris</a></li>
                <li><a href="single.html?id=30">Barcelona</a></li>
                <li><a href="single.html?id=29">New York</a></li>
                <li><a href="single.html?id=28">Chamonix</a></li>
                <li><a href="single.html?id=26">Sydfrankrig</a></li>
                <li><a href="single.html?id=24">Toscana</a></li>
                <li><a href="single.html?id=15">Sydspanien</a></li>
                <li><a href="single.html?id=13">Mallorca</a></li>
            </ul>
        </div>
        <section class="data-container"></section>
        <div>
            <h2 class="istand_title"></h2>
        </div>
        <p class="istand_content"></p>
    </section>


    <!------------Template for billedekarroussel-------------->
    <template>
        <article class="destinationer">
            <h3 class="sted"></h3>
            <img class="sted_pic" src="" alt="">
        </article>
    </template>

    <section class="carousel_section">
        <h2 class="carousel_title"></h2>
        <p class="carousel_content"></p>
        <div class="carousel">
            <div class="carousel_inner">
                <div class="bwd">
                    <p>&#9204;</p>
                </div>
                <div class="the_container"></div>
                <div class="fwd">
                    <p>&#9205;</p>
                </div>
            </div>
            <div class="preview_pics_container"></div>
        </div>
    </section>

    <template>
        <section>
            <img class="car_imgs" src="" alt="">
        </section>
    </template>

    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="far fa-arrow-alt-circle-up"></i></button>

    <footer>
        <ul>
            <li><a>Nyheder</a></li>
            <li><a>Presse</a></li>
            <li><a>Cookies og privatlivspolitik</a></li>
            <li><a href="faq.html">Ofte stillede spørgsmål</a></li>

        </ul>
        <div>
            <a href="https://www.facebook.com/enogtyvefem"><i class="fab fa-facebook-square fa-3x"></i></a>
            <a href="https://www.instagram.com/215moments/?hl=da"><i class="fab fa-instagram fa-3x"></i></a>
        </div>
    </footer>

    <script>
        //------------Renoveringsbilleder indhold-------
        const familyPics = "http://ianachristiansen.dk/21_5/wordpress/wp-json/wp/v2/renovering/1229";
        const theContainer = document.querySelector(".the_container");
        let numberOfPicsInCarousel;
        let carouCurrentNum = 0;



        const destPageURL = "http://ianachristiansen.dk/21_5/wordpress/wp-json/wp/v2/pages/524";
        const istandPageURL = "http://ianachristiansen.dk/21_5/wordpress/wp-json/wp/v2/pages/310";
        const postURL = "http://ianachristiansen.dk/21_5/wordpress/wp-json/wp/v2/destination";
        let destinationer = [];

        document.addEventListener("DOMContentLoaded", start);
        console.log("load");

        function start() {
            console.log("start");
            hentJSON();
        }

        /* json hentes her */
        async function hentJSON() {
            const responseDest = await fetch(destPageURL);
            const responseIstand = await fetch(istandPageURL);
            const responsePost = await fetch(postURL);

            const familyPicResponse = await fetch(familyPics);
            familyPicsJSON = await familyPicResponse.json();
            buildCarousel();
            document.querySelector(".fwd").addEventListener("click", fwd);
            document.querySelector(".bwd").addEventListener("click", bwd);

            /* json info defineres */
            topContent = await responseDest.json();
            bottomContent = await responseIstand.json();
            destinationer = await responsePost.json();

            visDest();
            visTop();
            visBottom();
        }


        /* funktionen viser hver destination i desktop */
        function visDest() {
            const container = document.querySelector(".data-container");
            const destTemplate = document.querySelector("template");

            /* destinationerne som vises */
            destinationer.forEach(destination => {
                console.log(destination);

                let klon = destTemplate.cloneNode(true).content;

                klon.querySelector(".sted").textContent = destination.overskrift;
                klon.querySelector(".sted_pic").src = destination.billede.guid;

                /* eventlistener som går til ny side ved klik på enkel destination */
                klon.querySelector(".destinationer").addEventListener("click", () => {
                    location.href = `single.html?id=${destination.id}`;
                });

                container.appendChild(klon)
            })
        }


        /* funktionen sætter titel på siden ind på siden */
        function visTop() {
            document.querySelector("h1").textContent = topContent.title.rendered;
        }

        /* funktionen sætter den nederste del ind. her istandsættelse osv. */
        function visBottom() {
            document.querySelector(".istand_title").innerHTML = bottomContent.title.rendered;
            document.querySelector(".istand_content").innerHTML = bottomContent.content.rendered;
        }

        /* HERFRA OG NED ER GALLERY RELATED */
        function buildCarousel() {
            numberOfPicsInCarousel = familyPicsJSON.bolig_img.length;

            familyPicsJSON.bolig_img.forEach((bolig_img, index) => {
                const theClone = document.querySelector("template").cloneNode(true).content;
                const secondClone = document.querySelector("template").cloneNode(true).content;

                theClone.querySelector("img").src = bolig_img.guid;
                secondClone.querySelector("img").src = bolig_img.guid;
                secondClone.querySelector("section").dataset.myIndex = index;


                document.querySelector(".carousel_title").innerHTML = familyPicsJSON.title.rendered;
                document.querySelector(".carousel_content").innerHTML = familyPicsJSON.content.rendered;

                theContainer.appendChild(theClone);
                document.querySelector(".preview_pics_container").appendChild(secondClone);

            })


            document.querySelector(".preview_pics_container section").classList.add("preview_selected");

            theContainer.addEventListener("scroll", scrollFunc);
            document.querySelectorAll(".preview_pics_container section").forEach(each => {
                each.addEventListener("click", previewClick);
            })
        }

        function scrollFunc() {
            document.querySelectorAll(".preview_pics_container section").forEach(each => {
                each.classList.remove("preview_selected")
            })
            carouCurrentNum = Math.round(theContainer.scrollLeft / document.querySelector(".car_imgs").width);
            document.querySelector(`.preview_pics_container section:nth-child(${carouCurrentNum+1})`).classList.add("preview_selected");
            setBtns();
        }

        function previewClick(evt) {
            carouCurrentNum = evt.currentTarget.dataset.myIndex;
            navigate();
        }

        function fwd() {
            if (carouCurrentNum < numberOfPicsInCarousel - 1) {
                carouCurrentNum++;
                navigate();
            }
        }

        function bwd() {
            if (carouCurrentNum > 0) {
                carouCurrentNum--;
                navigate();
            }
        }

        function navigate() {
            theContainer.scrollTo({
                left: carouCurrentNum * document.querySelector(".car_imgs").width,
                behavior: "smooth"
            })
            setBtns();
        }

        function setBtns() {
            if (carouCurrentNum < numberOfPicsInCarousel - 1) {
                document.querySelector(".fwd").style.opacity = 1;
                document.querySelector(".fwd").style.cursor = "pointer";
            } else {
                document.querySelector(".fwd").style.opacity = 0.3;
                document.querySelector(".fwd").style.cursor = "default";
            }
            if (carouCurrentNum > 0) {
                document.querySelector(".bwd").style.opacity = 1;
                document.querySelector(".bwd").style.cursor = "pointer";

            } else {
                document.querySelector(".bwd").style.opacity = 0.3;
                document.querySelector(".bwd").style.cursor = "default";
            }
        }
    </script>
    <script src="burger.js"></script>
</body></html>
